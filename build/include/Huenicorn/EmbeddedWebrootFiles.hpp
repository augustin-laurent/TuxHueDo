#pragma once

#include <unordered_map>
#include <string>
#include <filesystem>

namespace Huenicorn
{
  namespace Webroot
  {
    inline const std::unordered_map<std::filesystem::path, std::string> embeddedFiles = {
      {"404.html", "<!DOCTYPE html>\n<html>\n  <head>\n    <title>404 - Not found</title>\n    <link rel=\"stylesheet\" href=\"style.css\">\n  </head>\n\n  <body>\n    <h1>404 - Not found</h1>\n  </body>\n</html>\n\n"},
      {"Channel.js", "class Channel\n{\n  constructor(channelData, node = null)\n  {\n    this.channelId = channelData.channelId;\n    this.members = channelData.devices;\n    this.gammaFactor = channelData.gammaFactor;\n    this.node = node;\n\n    this.uvs = null;\n    if(channelData.uvs){\n      this.uvs = channelData.uvs;\n    }\n  }\n\n\n  membersNames()\n  {\n    return this.members.map(member => member.name);\n  }\n\n\n  formatMembers()\n  {\n    return `Channel ${this.channelId} : [ ${this.membersNames().join(\", \")} ]`;\n  }\n}\n"},
      {"Rainbow.js", "class Rainbow\n{\n  constructor()\n  {\n    this.hueIncrement = 180;\n  }\n\n\n  start()\n  {\n    document.documentElement.style.setProperty(\"--shadowRadius\", \"60px\");\n    this.rainbowInterval = setInterval(() => {\n      document.documentElement.style.setProperty(\"--rainbowColor\", `${this.hueIncrement}, 100%, 50%`);\n      this.hueIncrement = (this.hueIncrement + 1) % 360;\n    }, 50);\n  }\n\n\n  stop()\n  {\n    this.rainbowInterval.stop();\n  }\n}\n\n\nvar rainbow = new Rainbow();\nrainbow.start();"},
      {"ScreenWidget.js", "class Utils\n{\n  static clamp(value, min, max)\n  {\n    return Math.max(min, Math.min(value, max));\n  }\n\n\n  static truncate(value, decimals)\n  {\n    let exp = Math.pow(10, decimals);\n    return Math.round((value) * exp) / exp;\n  }\n}\n\n\nclass Handle\n{\n  static Type =\n  {\n    TopLeft : 0,\n    TopRight : 1,\n    BottomLeft : 2,\n    BottomRight : 3\n  };\n\n\n  static MapHandleTypeId =\n  {\n    \"tl\" : Handle.Type.TopLeft,\n    \"tr\" : Handle.Type.TopRight,\n    \"bl\" : Handle.Type.BottomLeft,\n    \"br\" : Handle.Type.BottomRight\n  };\n\n\n  constructor(handleId, screenWidget, parentNode)\n  {\n    this.handleNode = document.getElementById(handleId);\n    this.screenWidget = screenWidget;\n    this.parentNode = parentNode;\n    this.handleNode.addEventListener(\"mousedown\", () => {this.drag();});\n    this.type = Handle.MapHandleTypeId[handleId];\n  }\n\n\n  drag()\n  {\n    this.screenWidget.draggedHandle = this;\n  }\n\n\n  drop(){}\n\n\n  setPosition(position, notify = false)\n  {\n    let screenWidgetResolution = this.screenWidget.screenWidgetResolution();\n    let maxX = screenWidgetResolution.x;\n    let maxY = screenWidgetResolution.y;\n    let minX = 0;\n    let minY = 0;\n\n    let x = Utils.clamp(position.x, minX, maxX);\n    let y = Utils.clamp(position.y, minY, maxY);\n\n    x = Math.round(x * (this.screenWidget.subsampleWidth / screenWidgetResolution.x));\n    y = Math.round(y * (this.screenWidget.subsampleHeight / screenWidgetResolution.y));\n\n    let xNorm = x / (this.screenWidget.subsampleWidth);\n    let yNorm = y / (this.screenWidget.subsampleHeight);\n\n    this.handleNode.setAttribute(\"cx\", `${xNorm * 100}%`);\n    this.handleNode.setAttribute(\"cy\", `${yNorm * 100}%`);\n\n    let uvData = {\n      x : xNorm,\n      y : yNorm,\n      type : this.type\n    };\n\n    if(notify){\n      this.screenWidget._updateUVs(uvData);\n    }\n  }\n}\n\n\nclass GammaHandle\n{\n  constructor(screenWidget, parentNode)\n  {\n    this.screenWidget = screenWidget;\n    this.parentNode = parentNode;\n    this.handleNode = document.getElementById(\"gammaCursor\");\n    this.handleNode.addEventListener(\"mousedown\", () => {this.drag();});\n  }\n\n\n  drag()\n  {\n    this.screenWidget.draggedHandle = this;\n  }\n\n\n  affectFactor(factor)\n  {\n    factor += 1;\n    factor /= 2\n    factor *= this.screenWidget.gammaAreaDimensions().x;\n\n    this.setPosition({x : factor});\n  }\n\n\n  setPosition(position)\n  {\n    let areaDimensions = this.screenWidget.gammaAreaDimensions();\n    let gammaFactor =  Utils.clamp(position.x / areaDimensions.x, 0, 1);\n\n    gammaFactor = Utils.truncate(gammaFactor, 1)\n\n    this.handleNode.setAttribute(\"cx\", `${gammaFactor * 100}%`);\n\n    gammaFactor *= 2;\n    gammaFactor -= 1;\n    gammaFactor = Utils.truncate(gammaFactor, 1)\n\n    this.screenWidget.webApp.updateGammaFactor(gammaFactor);\n  }\n\n\n  drop(){}\n}\n\n\nclass Rectangle\n{\n  constructor(rectangleNode)\n  {\n    this.svgNode = rectangleNode;\n  }\n\n\n  setGeometry(x, y, width, height)\n  {\n    this.svgNode.setAttribute(\"x\", x);\n    this.svgNode.setAttribute(\"y\", y);\n    this.svgNode.setAttribute(\"width\", width);\n    this.svgNode.setAttribute(\"height\", height);\n  }\n\n\n  show(show = true)\n  {\n    let display = show ? \"block\" : \"none\";\n    this.svgNode.style.display = display;\n  }\n}\n\n\nclass ScreenWidget\n{\n  static Legends = {\n    none : \"\",\n    noChannel : \"There are currently no available channels. Please register them through official application.\",\n    pleaseDrag : \"Drag and and drop channel from 'inactive' to 'active' box to manage it.\",\n    pleaseSelect : \"Select an active channel to manage\"\n  };\n\n\n  constructor(webApp)\n  {\n    this.webApp = webApp;\n    this.svgAreaNode = document.getElementById(\"svgArea\");\n    this.screenAreaNode = document.getElementById(\"screenArea\");\n    this.gammaAreaNode = document.getElementById(\"gammaArea\");\n    this.uvRectangle = new Rectangle(document.getElementById(\"uvArea\"));\n    this.svgChannelMembersNamesNode = document.getElementById(\"svgChannelName\");\n    this.svgChannelUVSizeNode = document.getElementById(\"svgChannelUVSize\");\n    this.previewArea = document.getElementById(\"previewRectangles\");\n    this.legendText = document.getElementById(\"legendText\");\n    this.gridAreaNode = document.getElementById(\"gridArea\");\n\n    this.gammaCursor = new GammaHandle(this, this.gammaAreaNode);\n\n    let handleIds = [\"tl\", \"tr\", \"bl\", \"br\"];\n    this.handles = {}\n\n    for(let handleId of handleIds){\n      this.handles[handleId] = new Handle(handleId, this, this.screenAreaNode);\n    };\n\n    document.addEventListener(\"mouseup\", () => {this.drop();})\n    this.svgAreaNode.addEventListener(\"mousemove\", (event) => {this._updateMousePosition(event);});\n    this.svgAreaNode.addEventListener(\"mouseup\", () => {this.drop();});\n\n    this.draggedHandle = null;\n    this.currentChannel = null;\n  }\n\n\n  screenWidgetResolution()\n  {\n    let bbox = this.screenAreaNode.getBoundingClientRect();\n    return {x : bbox.width, y : bbox.height};\n  }\n\n\n  gammaAreaDimensions()\n  {\n    let bbox = this.gammaAreaNode.getBoundingClientRect();\n    return {x : bbox.width, y : bbox.height};\n  }\n\n\n  initChannelRegion(channel)\n  {\n    this.currentChannel = channel;\n    this._updateShape(channel.uvs);\n    this.showWidgets(true);\n\n    this.svgChannelMembersNamesNode.innerHTML = channel.formatMembers();\n  }\n\n\n  setLegend(legendFlag){\n    this.legendText.innerHTML = legendFlag;\n  }\n\n\n  setDimensions(width, height, subsampleWidth)\n  {\n    this.width = width;\n    this.height = height;\n\n    this.subsampleWidth = subsampleWidth;\n    this.subsampleHeight = this.height / this.width * subsampleWidth;\n\n    this.gridAreaNode.innerHTML = \"\";\n\n    if((this.screenWidgetResolution().x / this.subsampleWidth) < 2){\n      return;\n    }\n\n    for(let i = 0; i < this.subsampleWidth; i++){\n      let x = i / this.subsampleWidth;\n      var line = document.createElementNS(\"http://www.w3.org/2000/svg\", \"line\");\n\n      line.setAttribute(\"x1\", `${x * 100}%`);\n      line.setAttribute(\"x2\", `${x * 100}%`);\n      line.setAttribute(\"y1\", `0%`);\n      line.setAttribute(\"y2\", `100%`);\n      line.setAttribute(\"stroke\", \"var(--gridColor)\");\n      line.setAttribute(\"stroke-width\", \"1\");\n\n      this.gridAreaNode.appendChild(line);\n    }\n\n    for(let i = 0; i < this.subsampleHeight; i++){\n      let y = i / this.subsampleHeight;\n      var line = document.createElementNS(\"http://www.w3.org/2000/svg\", \"line\");\n\n      line.setAttribute(\"x1\", `0%`);\n      line.setAttribute(\"x2\", `100%`);\n      line.setAttribute(\"y1\", `${y * 100}%`);\n      line.setAttribute(\"y2\", `${y * 100}%`);\n      line.setAttribute(\"stroke\", \"var(--gridColor)\");\n      line.setAttribute(\"stroke-width\", \"1\");\n\n      this.gridAreaNode.appendChild(line);\n    }\n  }\n\n\n  showWidgets(show)\n  {\n    let display = show ? \"block\" : \"none\";\n    this.uvRectangle.show(show);\n    for(let [key, handle] of Object.entries(this.handles)){\n      handle.handleNode.style.display = display;\n    }\n\n    this.gammaAreaNode.style.display = display;\n    if(show){\n      this.gammaCursor.affectFactor(this.currentChannel.gammaFactor);\n    }\n  }\n\n\n  showPreview(exceptedChannelId = null)\n  {\n    this.previewArea.innerHTML = \"\";\n\n    let activeChannels = this.webApp.activeChannels;\n    let screenWidgetResolution = this.screenWidgetResolution();\n\n    if(!activeChannels){\n      return;\n    }\n\n    for(let activeChannelId of Object.keys(activeChannels)){\n      if(activeChannelId == exceptedChannelId){\n        continue;\n      }\n\n      let activeChannel = activeChannels[activeChannelId];\n\n      var rectNode = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\n      var textNode = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");\n\n      //textNode.innerHTML = activeChannel.name; // Todo\n      textNode.innerHTML = activeChannel.formatMembers();\n      textNode.setAttribute(\"fill\", \"rgba(255, 255, 255, 0.2)\");\n      textNode.setAttribute(\"text-anchor\", \"middle\");\n\n      let uvs = activeChannel.uvs;\n      let ax = uvs.uvA.x * screenWidgetResolution.x;\n      let ay = uvs.uvA.y * screenWidgetResolution.y;\n      let bx = uvs.uvB.x * screenWidgetResolution.x;\n      let by = uvs.uvB.y * screenWidgetResolution.y;\n      let width = bx - ax;\n      let height = by - ay;\n\n      textNode.setAttribute(\"x\", width / 2 + ax);\n      textNode.setAttribute(\"y\", height / 2 + ay);\n\n      rectNode.style.stroke = \"rgba(255, 255, 255, 0.2)\";\n      rectNode.style.strokeWidth = \"1px\";\n\n      let previewRectangle = new Rectangle(rectNode);\n\n      previewRectangle.setGeometry(ax, ay, width, height);\n\n      this.previewArea.appendChild(rectNode);\n      this.previewArea.appendChild(textNode);\n    }\n  }\n\n\n  drop()\n  {\n    if(this.draggedHandle){\n      this.draggedHandle.drop();\n      this.draggedHandle = null;\n    }\n  }\n\n\n  uvCallback(uvs)\n  {\n    this._updateShape(uvs);\n  }\n\n\n  _updateShape(uvs)\n  {\n    let screenWidgetResolution = this.screenWidgetResolution();\n\n    let ax = uvs.uvA.x * screenWidgetResolution.x;\n    let ay = uvs.uvA.y * screenWidgetResolution.y;\n    let bx = uvs.uvB.x * screenWidgetResolution.x;\n    let by = uvs.uvB.y * screenWidgetResolution.y;\n\n    this.handles[\"tl\"].setPosition({x : ax, y : ay});\n    this.handles[\"tr\"].setPosition({x : bx, y : ay});\n    this.handles[\"bl\"].setPosition({x : ax, y : by});\n    this.handles[\"br\"].setPosition({x : bx, y : by});\n\n    this.uvRectangle.setGeometry(ax, ay, bx - ax, by - ay);\n\n    let propWidth = Utils.truncate((uvs.uvB.x - uvs.uvA.x) * 100, 2);\n    let propHeight = Utils.truncate((uvs.uvB.y - uvs.uvA.y) * 100, 2);\n\n    this.svgChannelUVSizeNode.innerHTML = `${propWidth}% x ${propHeight}%`;\n  }\n\n\n  _updateMousePosition(event)\n  {\n    if(this.draggedHandle){\n      var ctm = this.draggedHandle.parentNode.getScreenCTM();\n\n      let point = {\n        x: (event.clientX - ctm.e) / ctm.a,\n        y: (event.clientY - ctm.f) / ctm.d\n      }\n\n      this.draggedHandle.setPosition(point, true);\n    }\n  }\n\n\n  _updateUVs(uvData)\n  {\n    this.webApp.notifyUV(uvData);\n  }\n}\n"},
      {"Utils.js", "class RequestUtils\n{\n  static get(url){\n    return new Promise((resolve, reject) => {\n      var xhr = new XMLHttpRequest();\n      xhr.open(\"GET\", url, true);\n      xhr.onreadystatechange = function(){\n        if(this.readyState === XMLHttpRequest.DONE && this.status === 200){\n          try{\n            let data = JSON.parse(xhr.responseText);\n            resolve(data);\n          }\n          catch(error){\n            reject(error);\n          }\n        }\n      };\n\n      xhr.onerror = (error) => {\n        reject(error);\n      };\n\n      xhr.send();\n    });\n  }\n\n  static post(url, data = {}){\n    return new Promise((resolve, reject) => {\n      var xhr = new XMLHttpRequest();\n      xhr.open(\"POST\", url);\n      xhr.setRequestHeader(\"Accept\", \"application/json\");\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n      xhr.onreadystatechange = function(){\n        if(this.readyState === XMLHttpRequest.DONE && this.status === 200){\n          try{\n            let data = JSON.parse(xhr.responseText);\n            resolve(data);\n          }\n          catch(error){\n            reject(error);\n          }\n        }\n      };\n\n      xhr.onerror = (error) => {\n        reject(error);\n      };\n\n      xhr.send(data);\n    });\n  }\n\n\n  static put(url, data = {}){\n    return new Promise((resolve, reject) => {\n      var xhr = new XMLHttpRequest();\n      xhr.open(\"PUT\", url);\n      xhr.setRequestHeader(\"Accept\", \"application/json\");\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n      xhr.onreadystatechange = function(){\n        if(this.readyState === XMLHttpRequest.DONE && this.status === 200){\n          try{\n            let data = JSON.parse(xhr.responseText);\n            resolve(data);\n          }\n          catch(error){\n            reject(error);\n          }\n        }\n      };\n\n      xhr.onerror = (error) => {\n        reject(error);\n      };\n\n      xhr.send(data);\n    });\n  }\n}\n\n\nclass MathUtils\n{\n  static roundPrecision(num, decimals)\n  {\n    let factor = Math.pow(10, decimals);\n    return Math.round(num * factor) / factor;\n  }\n}\n\n\nclass StyleUtils\n{\n  static greenRedGradient(proportion)\n  {\n    let rFactor = proportion;\n    let gFactor = 1 - proportion;\n    let bFactor = 0;\n\n    let norm = Math.sqrt(rFactor * rFactor + gFactor * gFactor + bFactor * bFactor);\n\n    rFactor /= norm;\n    gFactor /= norm;\n    bFactor /= norm;\n\n    return `rgb(${rFactor * 255}, ${gFactor * 255}, ${bFactor * 255})`;\n  }\n}\n"},
      {"Version.js", "function getVersion()\n{\n  let versionPromise = RequestUtils.get(\"/api/version\");\n  versionPromise.then((data) => {\n    let versionSection = document.getElementById(\"versionSection\");\n    let text = `Version ${data.version}`;\n    log(\"Huenicorn\", text);\n    versionSection.innerHTML = text;\n  });\n  versionPromise.catch((error) => {log(error);});\n}\n\ngetVersion();\n"},
      {"WebUI.js", "class WebUI\n{\n  constructor()\n  {\n    this.activeChannelsNode = document.getElementById(\"activeChannelsList\");\n    this.activeChannelsNode.addEventListener(\"drop\", (event) => {\n      this._setChannelActivity(JSON.parse(event.dataTransfer.getData(\"channelData\")).channelId, true);\n    });\n\n    this.inactiveChannelsNode = document.getElementById(\"inactiveChannelsList\");\n    this.inactiveChannelsNode.addEventListener(\"drop\", (event) => {\n      this._setChannelActivity(JSON.parse(event.dataTransfer.getData(\"channelData\")).channelId, false);\n    });\n\n    document.addEventListener(\"dragover\", (event) => {event.preventDefault();});\n\n    this.activeChannels = {};\n\n    this.screenWidget = new ScreenWidget(this);\n    \n    this.entertainmentConfigurationsNode = document.getElementById(\"entertainmentConfigurations\");\n    this.entertainmentConfigurationsSelectNode = document.getElementById(\"entertainmentConfigurationsSelect\");\n    this.entertainmentConfigurationsSelectNode.addEventListener(\"change\", (event) => {this._setEntertainmentConfiguration(event.target.value);});\n\n    this.advancedSettingsCheckbox = document.getElementById(\"advancedSettingsCheckbox\");\n    this.advancedSettingsCheckbox.addEventListener(\"click\", (e) => {this._toggleAdvancedDisplay(e.target.checked);});\n    this.advancedSettingsNode = document.getElementById(\"advancedSettings\");\n    this.availableSubsamplesNode = document.getElementById(\"availableSubsampleWidths\");\n    this.availableSubsamplesNode.addEventListener(\"change\", (event) => {this._setSubsampleWidth(parseInt(event.target.value));});\n    this.availableInterpolationsNode = document.getElementById(\"availableInterpolations\");\n    this.availableInterpolationsNode.addEventListener(\"change\", (event) => {this._setInterpolation(parseInt(event.target.value));});\n    this.refreshRateInputNode = document.getElementById(\"refreshRate\");\n    this.refreshRateInputNode.addEventListener(\"change\", (event) => {this._setRefreshRate(event.target.valueAsNumber);});\n\n    this.saveProfileButton = document.getElementById(\"saveProfileButton\");\n    this.saveProfileButton.addEventListener(\"click\", () => {this._saveProfile();});\n\n    this.stopButton = document.getElementById(\"stopButton\");\n    this.stopButton.addEventListener(\"click\", () => {this._askStopConfirmation()});\n    \n    this.overlay = document.getElementById(\"overlay\");\n\n    this.confirmStopButton = document.getElementById(\"confirmStopButton\");\n    this.confirmStopButton.addEventListener(\"click\", () => {this._stop();});\n    \n    this.cancelStopButton = document.getElementById(\"cancelStopButton\");\n    this.cancelStopButton.addEventListener(\"click\", () => {this.overlay.style.display = \"none\";});\n  }\n\n\n  initUI()\n  {\n    let channelsPromise = RequestUtils.get(\"/api/channels\");\n    channelsPromise.then((data) => {this._refreshChannelsLists(data);});\n    channelsPromise.catch((error) => {log(error);});\n\n    let displayInfoPromise = RequestUtils.get(\"/api/displayInfo\");\n    displayInfoPromise.then((data) => {this._displayInfoCallback(data);});\n    displayInfoPromise.catch((error) => {log(error);});\n\n    let interpolationInfoPromise = RequestUtils.get(\"/api/interpolationInfo\");\n    interpolationInfoPromise.then((data) => {this._interpolationInfoCallback(data);});\n    interpolationInfoPromise.catch((error) => {log(error);});\n\n    let entertainmentConfigurationsPromise = RequestUtils.get(\"/api/entertainmentConfigurations\");\n    entertainmentConfigurationsPromise.then((data) => {this._entertainmentConfigurationsCallback(data);});\n    entertainmentConfigurationsPromise.catch((error) => {log(error);});\n  }\n\n\n  notifyUV(uvData)\n  {\n    let uvPromise = RequestUtils.put(`/api/setChannelUV/${this.screenWidget.currentChannel.channelId}`, JSON.stringify(uvData));\n    uvPromise.then((checkedUVs) => {\n      this.activeChannels[this.screenWidget.currentChannel.channelId].uvs = checkedUVs;\n      this.screenWidget.uvCallback(checkedUVs);\n    });\n    uvPromise.catch((error) => {log(error);});\n  }\n\n\n  updateGammaFactor(gammaFactor)\n  {\n    if(!this.screenWidget.currentChannel){\n      return;\n    }\n\n    if(gammaFactor == this.screenWidget.currentChannel.gammaFactor){\n      return;\n    }\n\n    this.screenWidget.currentChannel.gammaFactor = gammaFactor;\n\n    let promise = RequestUtils.put(`/api/setChannelGammaFactor/${this.screenWidget.currentChannel.channelId}`, JSON.stringify({gammaFactor : gammaFactor}));\n    promise.then((gammaFactorData) => {\n      let gammaFactor = gammaFactorData.gammaFactor;\n      this.screenWidget.currentChannel.gammaFactor = Utils.truncate(gammaFactor, 2);\n    });\n    promise.catch((error) => {log(error);});\n  }\n\n\n  _initAdvancedSettings()\n  {\n    let showAdvancedSettings = false;\n    this.advancedSettingsCheckbox.checked = showAdvancedSettings;\n    this._toggleAdvancedDisplay(showAdvancedSettings);\n  }\n\n\n  _toggleAdvancedDisplay(checked)\n  {\n    if(checked){\n      this.advancedSettingsNode.style.display = \"block\";\n    }\n    else{\n      this.advancedSettingsNode.style.display = \"none\";\n    }\n  }\n\n\n  _setChannelActivity(channelId, active)\n  {\n    let promise = RequestUtils.post(`/api/setChannelActivity/${channelId}`, JSON.stringify({active : active}));\n    promise.then((data) => {\n      this._refreshChannelsLists(data.channels);\n      \n      if(\"newActiveChannelId\" in data){\n        this._manageChannel(data.newActiveChannelId);\n      }\n      else{\n        this.screenWidget.showWidgets(false);\n      }\n    });\n    promise.catch((error) => {log(error);});\n  }\n\n\n  _refreshChannelsLists(channels)\n  {\n    const activeChannels = channels.filter(channel => channel.active);\n    const inactiveChannels = channels.filter(channel => !channel.active);\n\n    this.activeChannels = {};\n    this._refreshActiveChannels(activeChannels);\n    this._refreshInactiveChannels(inactiveChannels);\n\n    if(channels.length == 0){\n      this.screenWidget.setLegend(ScreenWidget.Legends.noChannel);\n    }\n    else if(Object.keys(this.activeChannels).length == 0){\n      this.screenWidget.setLegend(ScreenWidget.Legends.pleaseDrag);\n      this.screenWidget.showWidgets(false);\n    }\n    else{\n      this.screenWidget.setLegend(ScreenWidget.Legends.pleaseSelect);\n    }\n    \n    this.screenWidget.showPreview();\n  }\n\n\n  _refreshActiveChannels(channels)\n  {\n    this.activeChannelsNode.innerHTML = \"\";\n    for(let channelData of channels){\n      let newChannelEntryNode = document.createElement(\"p\");\n      newChannelEntryNode.draggable = true;\n      newChannelEntryNode.selected = false;\n\n      let newChannel = new Channel(channelData, newChannelEntryNode)\n      newChannelEntryNode.addEventListener(\"dragstart\", (event) => {\n        event.dataTransfer.setData(\"channelData\", JSON.stringify(newChannel));\n      });\n\n      newChannelEntryNode.addEventListener(\"click\", (event) => {\n        this._manageChannel(channelData.channelId);\n      });\n\n      newChannelEntryNode.innerHTML = newChannel.formatMembers();\n\n      this.activeChannelsNode.appendChild(newChannelEntryNode);\n      this.activeChannels[newChannel.channelId] = newChannel;\n    }\n  }\n\n\n  _setItemSelected(channelNode, selected)\n  {\n    channelNode.selected = selected;\n\n    if(channelNode.selected){\n      channelNode.classList.add(\"selected\");\n    }\n    else{\n      channelNode.classList.remove(\"selected\");\n    }\n  }\n\n\n  _toggleClicked(channelNode)\n  {\n    this._setItemSelected(channelNode, !channelNode.selected);\n  }\n\n\n  _refreshInactiveChannels(channels)\n  {\n    this.inactiveChannelsNode.innerHTML = \"\";\n\n    for(let channelData of channels){\n      let newChannelEntryNode = document.createElement(\"p\");\n      newChannelEntryNode.draggable = true;\n\n      let newChannel = new Channel(channelData)\n      newChannelEntryNode.addEventListener(\"dragstart\", (event) => {\n        event.dataTransfer.setData(\"channelData\", JSON.stringify(newChannel));\n      });\n\n      newChannelEntryNode.innerHTML = newChannel.formatMembers();\n\n      this.inactiveChannelsNode.appendChild(newChannelEntryNode);\n    }\n  }\n\n\n  _displayInfoCallback(displayInfo)\n  {\n    let x = displayInfo.x;\n    let y = displayInfo.y;\n    let subsampleWidth = displayInfo.subsampleWidth;\n    this.refreshRateInputNode.value = displayInfo.selectedRefreshRate;\n    this.refreshRateInputNode.max = displayInfo.maxRefreshRate;\n\n    this.screenWidget.setDimensions(x, y, subsampleWidth);\n    let subsampleResolutionCandidates = displayInfo.subsampleResolutionCandidates;\n\n    this.availableSubsamplesNode.innerHTML = \"\";\n    for(let subsampleCandidate of subsampleResolutionCandidates.reverse()){\n      let newOption = document.createElement(\"option\");\n      let width = subsampleCandidate.x;\n      let height = subsampleCandidate.y;\n      let percentage = width / this.screenWidget.width * 100;\n      percentage = MathUtils.roundPrecision(percentage, 2);\n      newOption.innerHTML = width + \"x\" + height;\n      newOption.innerHTML += ` (${percentage}%)`;\n      newOption.value = width;\n      this.availableSubsamplesNode.appendChild(newOption);\n    }\n    \n    let proportion = parseInt(this.availableSubsamplesNode.value) / this.screenWidget.width;\n    let gradientColor = StyleUtils.greenRedGradient(proportion);\n    this.availableSubsamplesNode.style.color = gradientColor;\n\n    this._initAdvancedSettings();\n    this.availableSubsamplesNode.value = subsampleWidth.toString();\n  }\n\n\n  _interpolationInfoCallback(interpolationInfo)\n  {\n    let availableInterpolations = interpolationInfo.available;\n\n    this.availableInterpolationsNode.innerHTML = \"\";\n\n    for(let availableInterpolation of availableInterpolations){\n      let newOption = document.createElement(\"option\");\n\n      let key = Object.keys(availableInterpolation)[0];\n      let value = Object.values(availableInterpolation)[0];\n\n      newOption.innerHTML = key;\n      newOption.value = value;\n\n      this.availableInterpolationsNode.appendChild(newOption);\n    }\n\n    this.availableInterpolationsNode.value = interpolationInfo.current;\n  }\n\n  _entertainmentConfigurationsCallback(entertainmentConfigurationsData)\n  {\n    let entertainmentConfigurations = entertainmentConfigurationsData.entertainmentConfigurations;\n    let currentEntertainmentConfigurationId = entertainmentConfigurationsData.currentEntertainmentConfigurationId;\n\n    if(entertainmentConfigurations.length > 1){\n      this.entertainmentConfigurationsNode.style.display = \"block\";\n    }\n\n    for(let entertainmentConfiguration of entertainmentConfigurations){\n      let newOption = document.createElement(\"option\");\n      newOption.innerHTML = entertainmentConfiguration.name;\n      newOption.value = entertainmentConfiguration.entertainmentConfigurationId;\n      this.entertainmentConfigurationsSelectNode.appendChild(newOption);\n    }\n\n    this.entertainmentConfigurationsSelectNode.value = currentEntertainmentConfigurationId;\n  }\n\n\n  _manageChannel(channelId)\n  {\n    for(let loopChannelId of Object.keys(this.activeChannels)){\n      let channelNode = this.activeChannels[loopChannelId].node;\n      if(loopChannelId != channelId){\n        this._setItemSelected(channelNode, false);\n      }\n      else{\n        this._toggleClicked(channelNode);\n      }\n    }\n\n    if(!this.activeChannels[channelId].node.selected){\n      this.screenWidget.setLegend(ScreenWidget.Legends.pleaseSelect);\n      this.screenWidget.showWidgets(false);\n      this.screenWidget.showPreview();\n      this.screenWidget.currentChannel = null;\n\n      return;\n    }\n    else{\n      this.screenWidget.showPreview(channelId);\n    }\n\n    this.screenWidget.setLegend(ScreenWidget.Legends.none);\n\n    let channelPromise = RequestUtils.get(`/api/channel/${channelId}`);\n    channelPromise.then((channelData) => {\n      this.activeChannels[channelId].uvs = channelData.uvs;\n      this.screenWidget.initChannelRegion(this.activeChannels[channelId]);\n    });\n    channelPromise.catch((error) => {log(error);});\n  }\n\n\n  _setEntertainmentConfiguration(entertainmentConfigurationId)\n  {\n    this._showLoading(true, \"Switching configuration...\");\n    let promise = RequestUtils.put(\"/api/setEntertainmentConfiguration\", JSON.stringify(entertainmentConfigurationId));\n\n    promise.then((entertainmentConfigurationData) => {\n      this._refreshChannelsLists(entertainmentConfigurationData.channels)\n      this.screenWidget.showPreview();\n      this.screenWidget.showWidgets(false);\n      this._showLoading(false);\n    });\n    promise.catch((error) => {\n      log(error);\n      this._showLoading(false);\n    });\n  }\n\n\n  _setSubsampleWidth(subsampleWidth)\n  {\n    let promise = RequestUtils.put(\"/api/setSubsampleWidth\", JSON.stringify(subsampleWidth));\n    promise.then((displayInfo) => {\n      this.screenWidget.setDimensions(displayInfo.x, displayInfo.y, displayInfo.subsampleWidth);\n\n      let proportion = subsampleWidth / this.screenWidget.width;\n\n      let gradientColor = StyleUtils.greenRedGradient(proportion);\n      this.availableSubsamplesNode.style.color = gradientColor;\n    });\n    promise.catch((error) => {log(error);});\n  }\n\n\n  _setInterpolation(interpolation)\n  {\n    let promise = RequestUtils.put(\"/api/setInterpolation\", JSON.stringify(interpolation));\n    promise.catch((error) => {log(error);});\n  }\n\n\n  _setRefreshRate(refreshRate){\n    let promise = RequestUtils.put(\"/api/setRefreshRate\", JSON.stringify(refreshRate));\n    promise.then((data) => {this._setRefreshRateCallback(data.refreshRate);});\n    promise.catch((error) => {log(error);});\n  }\n\n\n  _setRefreshRateCallback(refreshRate)\n  {\n    this.refreshRateInputNode.value = refreshRate;\n  }\n\n\n  _saveProfile()\n  {\n    RequestUtils.post(\"/api/saveProfile\", JSON.stringify(null), (data) => {log(\"Saved profile\");});\n  }\n\n\n  _askStopConfirmation()\n  {\n    this.overlay.style.display = \"block\";\n    document.getElementById(\"confirmStopSection\").style.display = \"block\";\n  }\n\n\n  _stop()\n  {\n    let promise = RequestUtils.post(\"/api/stop\", JSON.stringify(null));\n    promise.then((data) => {\n      if(data.succeeded){\n        document.getElementById(\"confirmStopSection\").style.display = \"none\";\n        document.getElementById(\"stoppedInfoSection\").style.display = \"block\";\n      }\n    });\n  }\n\n\n  _showLoading(show, loadingText = null)\n  {\n    let loadingInfoSectionNode = document.getElementById(\"loadingInfoSection\");\n\n    if(show){\n      this.overlay.style.display = \"block\";\n      loadingInfoSectionNode.style.display = \"block\";\n      if(loadingText !== null){\n        document.getElementById(\"loadingTextInfo\").innerHTML = loadingText;\n      }\n    }\n    else{\n      this.overlay.style.display = \"none\";\n      loadingInfoSectionNode.style.display = \"none\";\n    }\n  }\n}\n"},
      {"index.html", "<!DOCTYPE html>\n<html>\n  <head>\n    <title>Huenicorn control interface</title>\n    <link rel=\"stylesheet\" href=\"style.css\">\n    <link rel=\"icon\" href=\"logo.svg\" sizes=\"any\" type=\"image/svg+xml\">\n  </head>\n\n  <body>\n    <h1>Huenicorn Light Manager</h1>\n\n    <svg width=\"960px\" height=\"540px\" id=\"svgArea\">\n      <!-- SVG area -->\n      <text x=\"50%\" y=\"30px\" fill=\"var(--foregroundColor)\" style=\"text-anchor: middle;\">Screen partitioning</text>\n      <text id=\"legendText\" x=\"50%\" y=\"50%\" fill=\"var(--foregroundColor)\" style=\"text-anchor: middle;\"></text>\n      <rect x=\"0%\" y=\"0%\" width=\"100%\" height=\"100%\"/>\n\n      <!-- Screen area -->\n      <svg x=\"10%\" y=\"10%\" width=\"80%\" height=\"80%\">\n        <rect x=\"0%\" y=\"0%\" width=\"100%\" height=\"100%\" id=\"screenArea\"/>\n        \n        <svg x=\"0%\" y=\"0%\" width=\"100%\" height=\"100%\" id=\"gridArea\"></svg>\n\n        <!-- UV area + handlers -->\n        <svg x=\"0%\" y=\"0%\" width=\"100%\" height=\"100%\">\n          <svg x=\"0%\" y=\"0%\" width=\"100%\" height=\"100%\" id=\"previewRectangles\"></svg>\n          <svg x=\"0%\" y=\"0%\" width=\"100%\" height=\"100%\" id=\"uvArea\" style=\"display: none;\">\n            <rect x=\"0%\" y=\"0%\" width=\"100%\" height=\"100%\"/>\n            <text id=\"svgChannelName\" x=\"50%\" y=\"50%\" dy=\"-0.5em\" fill=\"var(--foregroundColor)\" style=\"text-anchor: middle;\"></text>\n            <text id=\"svgChannelUVSize\" x=\"50%\" y=\"50%\" dy=\"0.5em\" fill=\"var(--foregroundColor)\" style=\"text-anchor: middle;\"></text>\n          </svg>\n\n          <circle r=\"2.5%\" cx=\"0%\" cy=\"0%\" class=\"handler\" id=\"tl\" style=\"display: none;\"/>\n          <circle r=\"2.5%\" cx=\"100%\" cy=\"0%\" class=\"handler\" id=\"tr\" style=\"display: none;\"/>\n          <circle r=\"2.5%\" cx=\"0%\" cy=\"100%\" class=\"handler\" id=\"bl\" style=\"display: none;\"/>\n          <circle r=\"2.5%\" cx=\"100%\" cy=\"100%\" class=\"handler\" id=\"br\" style=\"display: none;\"/>\n        </svg>\n      </svg>\n      <svg x=\"35%\" y=\"90%\" width=\"30%\" height=\"10%\">\n        <svg x=\"0%\" y=\"0%\" width=\"100%\" height=\"100%\" id=\"gammaArea\" style=\"display: none;\">\n          <text x=\"50%\" y=\"40%\" fill=\"var(--foregroundColor)\" style=\"text-anchor: middle;\">Gamma correction</text>\n          <line x1=\"0%\" y1=\"60%\" x2=\"100%\" y2=\"60%\" stroke=\"var(--foregroundColor)\"/>\n          <circle r=\"3.0%\" cx=\"50%\" cy=\"60%\" class=\"handler\" id=\"gammaCursor\"/>\n        </svg>\n      </svg>\n    </svg>\n\n\n    <section id=\"entertainmentConfigurations\">\n      <h2>Select entertainment configuration</h2>\n      <select id=\"entertainmentConfigurationsSelect\"></select>\n    </section>\n\n    <section id=\"channelLists\">\n      <div class=\"listContainer\">\n        <h2>Inactive channels</h2>\n        <div id=\"inactiveChannelsList\" class=\"channelList\"></div>\n      </div>\n\n      <div class=\"listContainer\">\n        <h2>Active channels</h2>\n        <div id=\"activeChannelsList\" class=\"channelList\"></div>\n      </div>\n    </section>\n\n    <section>\n      <h2>Advanced settings <input type=\"checkbox\" id=\"advancedSettingsCheckbox\"/> </h2>\n\n      <section id=\"advancedSettings\">\n        <p>Subsample resolution:<select id=\"availableSubsampleWidths\"></select></p>\n        <p>Interpolation :<select id=\"availableInterpolations\"></select></p>\n        <p>Refresh rate [Hz]: <input type=\"number\" id=\"refreshRate\" min=\"0\" step=\"1\" value=\"10\"/></p>\n      </section>\n    </section>\n\n    <p>\n      <button id=\"saveProfileButton\">Save profile</button>\n    </p>\n    <p>\n      <button id=\"stopButton\">Shut down</button>\n    </p>\n\n    <section id=\"versionSection\"></section>\n\n    <div id=\"overlay\">\n      <div class=\"overlayContent\">\n        <div id=\"confirmStopSection\" style=\"display: none;\">\n          <p>Do you really want to stop Huenicorn ?</p>\n          <button id=\"confirmStopButton\">Yes</button>\n          <button id=\"cancelStopButton\">No</button>\n        </div>\n\n        <div id=\"stoppedInfoSection\" style=\"display: none;\">\n          <p style=\"padding-top: 20px;\">Huenicorn is now off</p>\n        </div>\n\n        <div id=\"loadingInfoSection\" style=\"display: none;\">\n          <p style=\"padding-top: 20px;\" id=\"loadingTextInfo\"></p>\n        </div>\n      </div>\n    </div>\n\n    <script src=\"Channel.js\"></script>\n    <script src=\"Utils.js\"></script>\n    <script src=\"Version.js\"></script>\n    <script src=\"Rainbow.js\"></script>\n    <script src=\"ScreenWidget.js\"></script>\n    <script src=\"WebUI.js\"></script>\n    <script src=\"mainWebUI.js\"></script>\n  </body>\n</html>\n"},
      {"mainSetup.js", "log = console.log;\n\n\nclass SetupUI\n{\n  constructor()\n  {\n    this.setupSection = document.getElementById(\"setupSection\");\n    this.stepNodes = document.getElementsByClassName(\"step\");\n    this.errorMessages = document.getElementsByClassName(\"errorMessages\");\n\n    this.setConfigFilePath();\n\n    this.start();\n  }\n\n\n  setConfigFilePath()\n  {\n    RequestUtils.get(\"/api/configFilePath\", (jsonData) => {\n      let data = JSON.parse(jsonData);\n      let configFileLink = document.getElementById(\"configFilePath\");\n      configFileLink.href = `file://${data.configFilePath}`;\n      configFileLink.innerHTML = data.configFilePath;\n    })\n  }\n\n\n  start()\n  {\n    this.stepId = 0;\n    this._loadStep(this.stepId);\n  }\n\n\n  incStep()\n  {\n    this._loadStep(this.stepId + 1);\n  }\n\n\n  abort()\n  {\n    this._exit();\n  }\n\n\n  // Bridge address step\n  autodetectBridge()\n  {\n    let autodetectBridgePromise = RequestUtils.get(\"/api/autodetectBridge\");\n    autodetectBridgePromise.then((data) => {this.autodetectBridgeCallback(data)});\n    autodetectBridgePromise.catch((error) => {log(error);});\n  }\n\n\n  autodetectBridgeCallback(data)\n  {\n    let errorMessageNode = document.getElementById(\"bridgeAddressErrorMessage\");\n\n    if(data.succeeded){\n      let fieldNode = document.getElementById(\"bridgeAddress\");\n      let multipleBridgeNode = document.getElementById(\"multipleBridgeSection\");\n\n      if(data.bridges.length == 0){\n        errorMessageNode.style.visibility = \"visible\";\n        errorMessageNode.innerHTML = \"Bridge could not be found\";\n      }\n      else{\n        fieldNode.value = data.bridges[0].internalipaddress;\n\n        if(data.bridges.length > 1){\n          multipleBridgeNode.style.display = \"block\";\n\n          let bridgeCandidatesSelectNode = document.getElementById(\"bridgeCandidates\");\n          bridgeCandidatesSelectNode.addEventListener(\"change\", (event) => {fieldNode.value = (event.target.value);});\n\n          for(let bridge of data.bridges){\n            let newOption = bridgeCandidatesSelectNode.appendChild(document.createElement(\"option\"));\n            newOption.innerHTML = `${bridge.internalipaddress}`;\n          }\n        }\n        else{\n          multipleBridgeNode.style.display = \"none\";\n        }\n      }\n    }\n    else{\n      errorMessageNode.style.visibility = \"visible\";\n      errorMessageNode.innerHTML = data.error;\n    }\n  }\n\n\n  validateAddress()\n  {\n    let bridgeAddress = document.getElementById(\"bridgeAddress\").value;\n\n    if(bridgeAddress != \"\"){\n      let validateBridgeAddressPromise = RequestUtils.put(\"/api/validateBridgeAddress\", JSON.stringify({bridgeAddress : bridgeAddress}));\n      validateBridgeAddressPromise.then((data) => {this.validateBridgeAddressCallback(data);});\n      validateBridgeAddressPromise.catch((error) => {log(error);})\n    }\n    else{\n      let errorMessageNode = document.getElementById(\"bridgeAddressErrorMessage\");\n      errorMessageNode.style.visibility = \"visible\";\n      errorMessageNode.innerHTML = \"Please provide a valid address\";\n    }\n  }\n\n\n  validateBridgeAddressCallback(data)\n  {\n    if(data.succeeded){\n      this.incStep();\n    }\n    else{\n      let errorMessageNode = document.getElementById(\"bridgeAddressErrorMessage\");\n      errorMessageNode.style.visibility = \"visible\";\n      errorMessageNode.innerHTML = \"Could not resolve Hue bridge\";\n    }\n  }\n\n\n  // Credentials validation step\n  validateCredentials()\n  {\n    const username = document.getElementById(\"username\").value;\n    const clientkey = document.getElementById(\"clientkey\").value;\n    let errorMessageNode = document.getElementById(\"credentialsErrorMessage\");\n\n    if(username == \"\" || clientkey == \"\"){\n      errorMessageNode.style.visibility = \"visible\";\n      errorMessageNode.innerHTML = \"Please provide valid credentials (or quickly generate new ones)\";\n      return;\n    }\n\n    const regex = new RegExp(/^[A-F0-9]{32}$/);\n    if(!regex.test(clientkey)){\n      errorMessageNode.style.visibility = \"visible\";\n      errorMessageNode.innerHTML = \"The clientkey doesn't match the format of 32 hexadecimal characters\";\n      return;\n    }\n\n    let validateCredentialsPromise = RequestUtils.put(\"/api/validateCredentials\", JSON.stringify({username : username, clientkey : clientkey}));\n    validateCredentialsPromise.then((data) => {this.validateCredentialsCallback(data);});\n    validateCredentialsPromise.catch((error) => {log(error);});\n  }\n\n\n  validateCredentialsCallback(data)\n  {\n\n    if(data.succeeded){\n      this._finish();\n    }\n    else{\n      let errorMessageNode = document.getElementById(\"credentialsErrorMessage\");\n      errorMessageNode.style.visibility = \"visible\";\n      errorMessageNode.innerHTML = \"The provided username was denied\";\n    }\n  }\n\n\n  // Credentials generation step\n  registerNewUser()\n  {\n    let registerNewUserPromise = RequestUtils.put(\"/api/registerNewUser\", JSON.stringify(null));\n    registerNewUserPromise.then((data) => {this.registerNewUserCallback(data);});\n    registerNewUserPromise.catch((error) => {log(error);});\n  }\n\n\n  registerNewUserCallback(data)\n  {\n    if(data.succeeded){\n      this._finish();\n    }\n    else{\n      let errorMessageNode = document.getElementById(\"newUserErrorMessage\");\n      errorMessageNode.style.visibility = \"visible\";\n      errorMessageNode.innerHTML = \"Please press the central button on the bridge and try again\";\n    }\n  }\n\n\n  // Private methods\n  _loadStep(stepId)\n  {\n    this.stepId = stepId;\n    let i = 0;\n    for(let stepNode of this.stepNodes){\n      let display = (i++ == this.stepId) ? \"block\" : \"none\";\n      stepNode.style.display = display;\n    }\n\n    for(let errorMessageNode of this.errorMessages){\n      errorMessageNode.style.visibility = \"hidden\";\n      errorMessageNode.innerHTML = \"\";\n    }\n  }\n\n  _finish()\n  {\n    let finishSetupPromise = RequestUtils.post(\"/api/finishSetup\", JSON.stringify(null));\n    finishSetupPromise.then((data) => {log(\"Finished\");});\n    finishSetupPromise.catch((error) => {log(error);})\n\n    for(let stepNode of this.stepNodes){\n      stepNode.style.display = \"none\";\n    }\n\n    document.getElementById(\"finishSection\").style.display = \"block\";\n\n    this.pingFunctionInterval = setInterval(\n      this._ping\n      , 500);\n  }\n\n\n  _exit()\n  {\n    let abortPromise = RequestUtils.post(\"/api/abort\", JSON.stringify(null));\n    abortPromise.then((data) => {});\n    abortPromise.catch((error) => {log(error);});\n\n    for(let stepNode of this.stepNodes){\n      stepNode.style.display = \"none\";\n    }\n\n    document.getElementById(\"abortSection\").style.display = \"block\";\n  }\n\n\n  _ping()\n  {\n    let webUIStatusPromise = RequestUtils.get(\"/api/webUIStatus\");\n    webUIStatusPromise.then((data) => {\n      document.getElementById(\"refreshSection\").style.display = \"block\";\n      clearInterval(setupUI.pingFunctionInterval);\n    });\n    webUIStatusPromise.catch((error) => {log(error);});\n  }\n}\n\nlet setupUI = new SetupUI();\n"},
      {"mainWebUI.js", "log = console.log;\n\nlet webUI = new WebUI();\n\nwebUI.initUI();\n"},
      {"setup.html", "<!DOCTYPE html>\n<html>\n  <head>\n    <title>Huenicorn initial setup</title>\n    <link rel=\"stylesheet\" href=\"style.css\">\n    <link rel=\"icon\" href=\"logo.svg\" sizes=\"any\" type=\"image/svg+xml\">\n  </head>\n\n  <body>\n    <h1>Huenicorn initial setup</h1>\n\n    <section id=\"setupSection\">\n      <div class=\"step\">\n        <h1>Welcome !</h1>\n        <p>Huenicorn requires a quick initial setup to get started</p>\n        <button onclick=\"setupUI.incStep()\">Proceed</button>\n        <button onclick=\"setupUI.abort()\">Abort</button>\n      </div>\n\n      <div class=\"step\">\n        <h1>Identify Hue Bridge</h1>\n        <p>\n          Please enter the address of your Hue bridge<br/>\n          (or try an automatic identification)\n        </p>\n        <p><input type=\"text\" id=\"bridgeAddress\"/></p>\n        <p id=\"bridgeAddressErrorMessage\" class=\"errorMessage\"></p>\n        <p><button onclick=\"setupUI.autodetectBridge()\">Auto-detect</button></p>\n\n        <div id=\"multipleBridgeSection\" style=\"display: none\">\n          <p>You seem to have multiple bridges.<br/>Please select one below (or input it manually above):</p>\n          \n          <p><select id=\"bridgeCandidates\"></select></p>\n        </div>\n\n        <button onclick=\"setupUI.validateAddress()\">Validate</button>\n        <button onclick=\"setupUI.abort()\">Abort</button>\n      </div>\n\n      <div class=\"step\">\n        <h1>API key</h1>\n        <p>\n          Some credentials are required to manage the Hue bridge.\n        </p>\n        <p>\n          If you already have these informations and can retrieve them, they can be provided in the fields below.\n        </p>\n        <p><label>Username:</label><input type=\"text\" id=\"username\"/></p>\n        <p><label>Clientkey:</label><input type=\"text\" id=\"clientkey\"/></p>\n        <p id=\"credentialsErrorMessage\" class=\"errorMessage\"></p>\n        \n        <p>\n          <button onclick=\"setupUI.validateCredentials()\" style=\"width: 200px\">Validate</button>\n          <button onclick=\"setupUI.incStep()\" style=\"width: 200px\">I don't have credentials yet</button>\n        </p>\n        <button onclick=\"setupUI.abort()\">Abort</button>\n      </div>\n\n      <div class=\"step\">\n        <h1>Register a new user</h1>\n        <p>\n          In order to register a new user, you now need to press the central button on your Hue bridge.\n        </p>\n        <p>\n          Once this is done, you have one minute to press the registration button below.\n        </p>\n        <p id=\"newUserErrorMessage\" class=\"errorMessage\"></p>\n        <p>\n          <button onclick=\"setupUI.registerNewUser()\" style=\"width: 200px\">Register new user</button>\n        </p>\n        <button onclick=\"setupUI.abort()\">Abort</button>\n      </div>\n\n      <div id=\"finishSection\" style=\"display: none;\">\n        <h1>\n          Huenicorn is now ready !\n        </h1>\n        \n        <p>Feel free to manually edit the config file located at<br/>\n          <a id=\"configFilePath\"></a>\n        </p>\n        <p>\n          The Light Manager will be available at this current page address.<br/>\n          You might want to bookmark it for further use.\n        </p>\n        \n        <div id=\"refreshSection\" style=\"display: none\">\n          <p>You can now refresh this page to access the Light Manager</p>\n          <p><button onclick=\"window.location.reload()\">Refresh</button></p>\n        </div>\n      </div>\n\n      <div id=\"abortSection\" style=\"display: none;\">\n        <h1>The setup was aborted</h1>\n        <p>Hope to see you again soon !</p>\n      </div>\n    </section>\n\n    <section id=\"versionSection\"></section>\n\n    <script src=\"Utils.js\"></script>\n    <script src=\"Version.js\"></script>\n    <script src=\"Rainbow.js\"></script>\n    <script src=\"mainSetup.js\"></script>\n  </body>\n</html>\n"},
      {"style.css", ":root\n{\n  --foregroundColor: #ffffff;\n  --backgroundColor: #000000;\n  --borderColor: rgba(255, 255, 255, 0.1);\n  --gridColor: rgba(255, 255, 255, 0.05);\n  --border: 1px solid var(--borderColor);\n\n  --shadowRadius: 25px;\n  --rainbowColor: 0, 100%, 100%;\n  --shadow: 0px 0px var(--shadowRadius) hsla(var(--rainbowColor), 0.8);\n  --lightShadow: 0px 0px var(--shadowRadius) hsla(var(--rainbowColor), 0.4);\n  --border: 1px solid rgba(255, 255, 255, 0.5);\n  --borderRadius: 10px;\n}\n\n\nbody\n{\n  width: 1024px;\n  margin-left: auto;\n  margin-right: auto;\n  text-align: center;\n  background-color: var(--backgroundColor);\n  color: var(--foregroundColor);\n  font-family: Verdana, Geneva, Tahoma, sans-serif;\n}\n\n\nh2\n{\n  font-size: 20px;\n}\n\n\nh1, h2\n{\n  margin-top: 0px;\n  text-shadow: 0px 0px 50px hsla(var(--rainbowColor), 1.0);\n}\n\n\nbutton\n{\n  /*width: 400px;*/\n  width: 100px;\n  height: 30px;\n  background-color: var(--backgroundColor);\n  color: var(--foregroundColor);\n  border: var(--border);\n  box-shadow: var(--shadow);\n  border-radius: var(--borderRadius);\n}\n\n\nbutton:hover\n{\n  box-shadow: inset var(--shadow);\n}\n\n\nselect, input[type=number]\n{\n  text-align: center;\n  background-color: var(--backgroundColor);\n  color: var(--foregroundColor);\n  border: var(--border);\n  border-radius: var(--borderRadius);\n  margin-left: 20px;\n}\n\n\ninput[type=number]\n{\n  width: 80px;\n}\n\n\nlabel\n{\n  margin-right: 10px;\n}\n\n\ninput[type=text]\n{\n  text-align: center;\n  width: 300px;\n}\n\n\n#channelLists\n{\n  width: 800px;\n  display: inline-block;\n  margin-bottom: 20px;\n}\n\n\n.listContainer\n{\n  display: inline-block;\n}\n\n\n.channelList\n{\n  height: 125px;\n  width: 300px;\n  margin-left: 20px;\n  margin-right: 20px;\n  box-shadow: var(--shadow);\n  overflow: hidden;\n  overflow-y: scroll;\n  border: var(--border);\n  border-radius: var(--borderRadius);\n}\n\n\n#advancedSettings, #setupSection\n{\n  width: 400px;\n  margin-left: auto;\n  margin-right: auto;\n  margin-bottom: 20px;\n  padding: 20px;\n  box-shadow: var(--shadow);\n  border: var(--border);\n  border-radius: var(--borderRadius);\n}\n\n\n#entertainmentConfigurations\n{\n  display: none;\n  margin-top: 20px;\n  margin-bottom: 20px;\n}\n\n\n#entertainmentConfigurationsSelect\n{\n  width: 200px;\n}\n\n\n#setupSection\n{\n  width: 600px;\n}\n\n\n#versionSection\n{\n  font-size: 0.6em;\n  position: fixed;\n  bottom: 0px;\n  left: 0px;\n  z-index: -1;\n  text-shadow: 0px 0px 5px hsla(var(--rainbowColor), 1.0);\n}\n\n.channelList>p\n{\n  margin: 0px;\n  padding: 10px;\n  font-size: 10pt;\n  border-bottom: var(--border);\n}\n\n\n.channelList>p:hover\n{\n  cursor: grab;\n  box-shadow: inset var(--lightShadow);\n}\n\n.channelList>p.selected\n{\n  box-shadow: inset var(--shadow);\n}\n\n\n.handler\n{\n  fill: hsla(var(--rainbowColor), 0.5);\n  stroke:rgba(255, 255, 255, 1.0);\n}\n\n\n.handler:hover\n{\n  fill: hsla(var(--rainbowColor), 1.0);\n  cursor: grab;\n}\n\n\n.step\n{\n  padding-bottom: 20px;\n}\n\n\n.errorMessage\n{\n  visibility: hidden;\n  color: #ff8800;\n}\n\n\n#svgArea\n{\n  fill: hsla(var(--rainbowColor), 0.025);\n  border: var(--border);\n  box-shadow: var(--shadow);\n  border-radius: var(--borderRadius);\n}\n\n\n#screenArea, #uvArea\n{\n  fill: hsla(var(--rainbowColor), 0.25);\n}\n\n\n#overlay\n{\n  display: none;\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  top: 0px;\n  bottom: 0px;\n  left: 0px;\n  right: 0px;\n  background-color: rgba(0, 0, 0, 0.5);\n}\n\n\n.overlayContent\n{\n  position: absolute;\n  width: 300px;\n  padding-bottom: 20px;\n  padding-left: 20px;\n  padding-right: 20px;\n  z-index: 2;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%,-50%);\n  border: var(--border);\n  background-color: var(--backgroundColor);\n  border-radius: var(--borderRadius);\n}\n"},
      {"logo.svg", "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!-- Created with Inkscape (http://www.inkscape.org/) -->\n\n<svg\n   width=\"99.998062mm\"\n   height=\"99.996109mm\"\n   viewBox=\"0 0 99.998059 99.996111\"\n   version=\"1.1\"\n   id=\"svg1\"\n   inkscape:version=\"1.3.2 (091e20ef0f, 2023-11-25, custom)\"\n   sodipodi:docname=\"huenicorn.svg\"\n   inkscape:export-filename=\"huenicorn.png\"\n   inkscape:export-xdpi=\"96\"\n   inkscape:export-ydpi=\"96\"\n   xmlns:inkscape=\"http://www.inkscape.org/namespaces/inkscape\"\n   xmlns:sodipodi=\"http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd\"\n   xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n   xmlns=\"http://www.w3.org/2000/svg\"\n   xmlns:svg=\"http://www.w3.org/2000/svg\">\n  <sodipodi:namedview\n     id=\"namedview1\"\n     pagecolor=\"#ffffff\"\n     bordercolor=\"#000000\"\n     borderopacity=\"0.25\"\n     inkscape:showpageshadow=\"2\"\n     inkscape:pageopacity=\"0.0\"\n     inkscape:pagecheckerboard=\"0\"\n     inkscape:deskcolor=\"#d1d1d1\"\n     inkscape:document-units=\"mm\"\n     inkscape:zoom=\"0.65952826\"\n     inkscape:cx=\"17.436705\"\n     inkscape:cy=\"426.06211\"\n     inkscape:window-width=\"1955\"\n     inkscape:window-height=\"1380\"\n     inkscape:window-x=\"0\"\n     inkscape:window-y=\"0\"\n     inkscape:window-maximized=\"0\"\n     inkscape:current-layer=\"g48\"\n     showgrid=\"false\">\n    <inkscape:grid\n       id=\"grid1\"\n       units=\"px\"\n       originx=\"-79.259546\"\n       originy=\"-9.4000006\"\n       spacingx=\"0.26458333\"\n       spacingy=\"0.26458334\"\n       empcolor=\"#0099e5\"\n       empopacity=\"0.30196078\"\n       color=\"#0099e5\"\n       opacity=\"0.14901961\"\n       empspacing=\"5\"\n       dotted=\"false\"\n       gridanglex=\"30\"\n       gridanglez=\"30\"\n       visible=\"false\" />\n    <inkscape:page\n       x=\"0\"\n       y=\"0\"\n       width=\"99.998055\"\n       height=\"99.996109\"\n       id=\"page7\"\n       margin=\"0\"\n       bleed=\"0\"\n       inkscape:export-filename=\"huenicorn-square.svg\"\n       inkscape:export-xdpi=\"96\"\n       inkscape:export-ydpi=\"96\" />\n  </sodipodi:namedview>\n  <defs\n     id=\"defs1\">\n    <linearGradient\n       id=\"linearGradient71\"\n       inkscape:collect=\"always\">\n      <stop\n         style=\"stop-color:#000000;stop-opacity:1;\"\n         offset=\"0\"\n         id=\"stop73\" />\n      <stop\n         style=\"stop-color:#000000;stop-opacity:0;\"\n         offset=\"1\"\n         id=\"stop74\" />\n    </linearGradient>\n    <linearGradient\n       id=\"linearGradient31\"\n       inkscape:collect=\"always\">\n      <stop\n         style=\"stop-color:#000000;stop-opacity:1;\"\n         offset=\"0\"\n         id=\"stop31\" />\n      <stop\n         style=\"stop-color:#000000;stop-opacity:0;\"\n         offset=\"1\"\n         id=\"stop34\" />\n    </linearGradient>\n    <linearGradient\n       id=\"linearGradient29\"\n       inkscape:collect=\"always\">\n      <stop\n         style=\"stop-color:#000000;stop-opacity:1;\"\n         offset=\"0\"\n         id=\"stop29\" />\n      <stop\n         style=\"stop-color:#000000;stop-opacity:0;\"\n         offset=\"1\"\n         id=\"stop30\" />\n    </linearGradient>\n    <linearGradient\n       id=\"linearGradient80\"\n       inkscape:collect=\"always\">\n      <stop\n         style=\"stop-color:#ffffff;stop-opacity:0;\"\n         offset=\"0\"\n         id=\"stop81\" />\n      <stop\n         style=\"stop-color:#ffffff;stop-opacity:0;\"\n         offset=\"1\"\n         id=\"stop82\" />\n    </linearGradient>\n    <linearGradient\n       id=\"linearGradient79\"\n       inkscape:collect=\"always\">\n      <stop\n         style=\"stop-color:#ffffff;stop-opacity:1;\"\n         offset=\"0\"\n         id=\"stop79\" />\n      <stop\n         style=\"stop-color:#ffffff;stop-opacity:0;\"\n         offset=\"1\"\n         id=\"stop80\" />\n    </linearGradient>\n    <linearGradient\n       id=\"linearGradient76\"\n       inkscape:collect=\"always\">\n      <stop\n         style=\"stop-color:#ffffff;stop-opacity:1;\"\n         offset=\"0\"\n         id=\"stop78\" />\n      <stop\n         style=\"stop-color:#5118c2;stop-opacity:1;\"\n         offset=\"1\"\n         id=\"stop77\" />\n    </linearGradient>\n    <linearGradient\n       id=\"linearGradient72\"\n       inkscape:collect=\"always\">\n      <stop\n         style=\"stop-color:#0f00ff;stop-opacity:1;\"\n         offset=\"0\"\n         id=\"stop85\" />\n      <stop\n         style=\"stop-color:#51ff00;stop-opacity:1;\"\n         offset=\"0.25648415\"\n         id=\"stop69\" />\n      <stop\n         style=\"stop-color:#e5ff00;stop-opacity:1;\"\n         offset=\"0.46387699\"\n         id=\"stop70\" />\n      <stop\n         style=\"stop-color:#ff6700;stop-opacity:1;\"\n         offset=\"0.6474849\"\n         id=\"stop71\" />\n      <stop\n         style=\"stop-color:#5017c2;stop-opacity:1;\"\n         offset=\"1\"\n         id=\"stop72\" />\n    </linearGradient>\n    <linearGradient\n       id=\"linearGradient68\"\n       inkscape:collect=\"always\">\n      <stop\n         style=\"stop-color:#5117c1;stop-opacity:1;\"\n         offset=\"0\"\n         id=\"stop67\" />\n      <stop\n         style=\"stop-color:#ffffff;stop-opacity:1;\"\n         offset=\"1\"\n         id=\"stop68\" />\n    </linearGradient>\n    <linearGradient\n       id=\"linearGradient32\"\n       inkscape:collect=\"always\">\n      <stop\n         style=\"stop-color:#ffffff;stop-opacity:1;\"\n         offset=\"0\"\n         id=\"stop33\" />\n      <stop\n         style=\"stop-color:#5117c1;stop-opacity:1;\"\n         offset=\"1\"\n         id=\"stop32\" />\n    </linearGradient>\n    <linearGradient\n       id=\"linearGradient12\"\n       inkscape:swatch=\"gradient\">\n      <stop\n         style=\"stop-color:#8d17c1;stop-opacity:1;\"\n         offset=\"0\"\n         id=\"stop12\" />\n      <stop\n         style=\"stop-color:#8d17c1;stop-opacity:0;\"\n         offset=\"1\"\n         id=\"stop13\" />\n    </linearGradient>\n    <clipPath\n       clipPathUnits=\"userSpaceOnUse\"\n       id=\"clipPath25\">\n      <rect\n         style=\"fill:#ff0000;stroke:none;stroke-width:3;stroke-linecap:square;stroke-linejoin:miter;paint-order:stroke markers fill;stop-color:#000000\"\n         id=\"rect25-8\"\n         width=\"78\"\n         height=\"45.033199\"\n         x=\"763.61322\"\n         y=\"452.82422\" />\n    </clipPath>\n    <linearGradient\n       id=\"swatch9\">\n      <stop\n         style=\"stop-color:#ff0000;stop-opacity:1;\"\n         offset=\"0\"\n         id=\"stop10\" />\n    </linearGradient>\n    <linearGradient\n       inkscape:collect=\"always\"\n       xlink:href=\"#linearGradient32\"\n       id=\"linearGradient35\"\n       gradientUnits=\"userSpaceOnUse\"\n       gradientTransform=\"rotate(8.0476539,136.03077,132.68291)\"\n       x1=\"187.56837\"\n       y1=\"194.45236\"\n       x2=\"146.46986\"\n       y2=\"120.78633\" />\n    <linearGradient\n       inkscape:collect=\"always\"\n       xlink:href=\"#linearGradient68\"\n       id=\"linearGradient36\"\n       gradientUnits=\"userSpaceOnUse\"\n       x1=\"40.106956\"\n       y1=\"6.6279764\"\n       x2=\"190.6181\"\n       y2=\"115.85823\" />\n    <linearGradient\n       inkscape:collect=\"always\"\n       xlink:href=\"#linearGradient72\"\n       id=\"linearGradient37\"\n       gradientUnits=\"userSpaceOnUse\"\n       gradientTransform=\"rotate(7.3667678,92.987102,87.341964)\"\n       x1=\"20.663397\"\n       y1=\"35.507965\"\n       x2=\"49.867676\"\n       y2=\"49.603386\" />\n    <linearGradient\n       inkscape:collect=\"always\"\n       xlink:href=\"#linearGradient76\"\n       id=\"linearGradient38\"\n       gradientUnits=\"userSpaceOnUse\"\n       x1=\"26.273703\"\n       y1=\"195.93607\"\n       x2=\"150.92778\"\n       y2=\"35.620163\" />\n    <linearGradient\n       inkscape:collect=\"always\"\n       xlink:href=\"#linearGradient71\"\n       id=\"linearGradient40\"\n       gradientUnits=\"userSpaceOnUse\"\n       x1=\"71.907471\"\n       y1=\"173.53757\"\n       x2=\"112.16912\"\n       y2=\"122.78528\" />\n    <linearGradient\n       inkscape:collect=\"always\"\n       xlink:href=\"#linearGradient31\"\n       id=\"linearGradient41\"\n       gradientUnits=\"userSpaceOnUse\"\n       x1=\"66.7649\"\n       y1=\"78.078133\"\n       x2=\"89.952171\"\n       y2=\"96.391548\" />\n    <radialGradient\n       inkscape:collect=\"always\"\n       xlink:href=\"#linearGradient79\"\n       id=\"radialGradient41\"\n       gradientUnits=\"userSpaceOnUse\"\n       gradientTransform=\"matrix(0.19137961,0.20571408,-0.46036291,0.42828407,70.093803,15.568563)\"\n       cx=\"54.64563\"\n       cy=\"49.082573\"\n       fx=\"54.64563\"\n       fy=\"49.082573\"\n       r=\"12.056826\" />\n    <linearGradient\n       inkscape:collect=\"always\"\n       xlink:href=\"#linearGradient80\"\n       id=\"linearGradient42\"\n       gradientUnits=\"userSpaceOnUse\"\n       x1=\"57.956066\"\n       y1=\"47.831223\"\n       x2=\"60.263496\"\n       y2=\"50.311481\" />\n    <linearGradient\n       inkscape:collect=\"always\"\n       xlink:href=\"#linearGradient29\"\n       id=\"linearGradient43\"\n       gradientUnits=\"userSpaceOnUse\"\n       x1=\"58.723656\"\n       y1=\"53.328949\"\n       x2=\"76.048775\"\n       y2=\"57.150188\" />\n  </defs>\n  <g\n     inkscape:label=\"Huenicorn\"\n     inkscape:groupmode=\"layer\"\n     id=\"g48\"\n     style=\"display:inline;fill:#181818;fill-opacity:1\"\n     transform=\"matrix(-1,0,0,1,127.62295,-26.553679)\"\n     sodipodi:insensitive=\"true\">\n    <path\n       id=\"path1-2\"\n       style=\"display:inline;fill:url(#linearGradient35);fill-opacity:1;stroke-width:0.264583\"\n       inkscape:label=\"Tail\"\n       d=\"m 151.82544,136.02993 c 0.18438,2.0446 -0.0592,3.37413 -0.0592,3.37413 l -1.05128,4.03595 3.82008,5.16461 c 0,0 5.40671,5.79324 7.31576,9.19458 5.46337,9.7342 11.42983,31.35452 11.42983,31.35452 0,0 6.38978,-18.09272 5.95583,-27.43097 -0.22151,-4.76735 -1.48785,-9.79318 -4.32743,-13.68741 -2.82308,-3.87163 -7.43935,-6.2887 -11.78281,-8.45153 -3.40828,-1.69717 -10.47537,-3.3621 -11.30122,-3.55389 z\"\n       sodipodi:nodetypes=\"ccccscssscc\" />\n    <path\n       id=\"path48\"\n       style=\"display:inline;fill:url(#linearGradient36);fill-opacity:1;stroke-width:0.265;stroke-dasharray:none\"\n       inkscape:label=\"Hair\"\n       d=\"m 80.378441,32.398136 c -3.613049,-0.589583 -7.291472,-0.84532 -10.952188,-0.815568 -3.265624,0.02654 -9.757027,0.886251 -9.757027,0.886251 l -0.362768,4.045231 4.438488,2.969845 c 0,0 14.58787,3.206404 19.924596,4.620447 4.754999,1.259906 9.613903,3.751437 13.491569,6.778167 10.390079,8.110023 26.301639,28.281134 26.301639,28.281134 4.16676,35.286327 3.25624,6.567224 3.25624,6.567224 0,0 -0.182,-5.009781 -4.71547,-17.928231 C 117.21798,54.165851 113.01913,50.228765 109.24151,46.5383 104.73884,42.139519 98.482966,38.153484 92.304272,35.432921 88.550112,33.779913 84.426863,33.058764 80.378441,32.398136 Z\"\n       sodipodi:nodetypes=\"aacccssccssaa\" />\n    <path\n       id=\"path1-6\"\n       style=\"display:inline;fill:url(#linearGradient37);fill-opacity:1;stroke:#000000;stroke-width:0.264583;stroke-opacity:0\"\n       inkscape:label=\"Horn\"\n       d=\"m 27.705295,26.669658 25.91471,19.818745 3.641514,-3.600724 z\"\n       sodipodi:nodetypes=\"cccc\" />\n    <path\n       id=\"path2\"\n       style=\"display:inline;fill:url(#linearGradient38);fill-opacity:1;stroke-width:0.264583\"\n       d=\"m 141.68359,158.33458 c -2.24199,4.54483 3.10527,13.2826 3.10527,13.2826 l 6.45462,13.30976 -8.70184,19.71625 0.65859,6.9039 -10.30171,5.7e-4 0.10363,-7.02555 11.16362,-18.81547 -7.89897,-7.90032 c 0,0 -11.28213,-10.17304 -13.73408,-17.34919 -2.22088,-6.49989 -0.82754,-13.95184 -2.79415,-20.54475 -2.85039,-9.55568 -6.11815,-19.78209 -11.6757,-26.26565 -6.03333,-7.03862 -22.526159,-16.311382 -22.526159,-16.311382 0,0 -6.5e-4,-0.01293 0.854863,8.550822 C 72.362805,101.8516 60.189625,92.530488 60.189625,92.530488 l 2.027791,3.041103 4.658113,5.482509 -10.344783,0.82436 -4.081592,-5.348184 c 0,0 -0.436393,-5.201461 0.825566,-7.300168 C 54.399942,87.358803 58.6788,85.5278 58.6788,85.5278 l 14.148097,5.163594 c 0,0 -2.961752,-5.26461 -2.929045,-8.151764 0.0434,-3.830656 4.130256,-10.724889 4.130256,-10.724889 l -6.349689,-9.157483 c 0,0 -2.92539,-0.832133 -12.743663,2.721668 0,0 -0.04195,0.04348 -19.373782,7.012494 -2.618227,0.943856 -1.774418,-6.767043 -1.06705,-7.444897 4.503671,-4.315762 23.787408,-23.119566 23.787408,-23.119566 l -2.291283,-7.532051 7.754752,5.189222 c 0,0 10.727721,-0.360165 22.671737,4.963623 6.299095,2.807685 12.381513,6.94045 15.895082,10.383168 10.90513,10.685239 15.35309,15.284281 21.15112,24.332971 3.55985,5.555674 5.32776,12.075013 8.14649,18.04098 3.31434,7.01494 9.84061,12.10318 14.9313,19.41062 2.77832,3.98815 5.77217,14.0859 5.37521,21.78118 -0.39696,7.69529 -8.70229,16.83664 -10.23215,19.93791 z\"\n       sodipodi:nodetypes=\"sccccccccssscccccccsccsccssscccssasscs\"\n       inkscape:label=\"Body\" />\n    <path\n       id=\"path70\"\n       style=\"display:inline;fill:url(#linearGradient40);stroke-width:0.264583\"\n       inkscape:label=\"LegShadow\"\n       d=\"m 111.45315,111.56632 3.53105,14.23789 c 1.83579,4.51317 3.34711,9.39095 4.75423,14.10818 0.6727,2.25518 0.91654,4.61947 1.0821,7.00319 -0.26651,-4.72847 -0.17673,-12.64346 2.9931,-15.99179 13.15997,-13.901 4.90048,-5.22345 4.90048,-5.22345 z m 9.45885,36.7223 c 0.0358,0.64769 0.0962,1.28955 0.12867,1.93787 l 0.10904,0.44028 c 0,0 -0.12366,-0.92208 -0.23771,-2.37815 z\" />\n    <path\n       style=\"display:inline;fill:url(#linearGradient41);stroke-width:0.264999\"\n       d=\"M 85.534125,97.343094 84.495173,88.45067 89.994544,99.976334 Z\"\n       id=\"path13\"\n       inkscape:label=\"ArmShadow\"\n       sodipodi:nodetypes=\"cccc\" />\n    <path\n       style=\"fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.302725;stroke-dasharray:none;stroke-opacity:0\"\n       d=\"m 53.821964,50.943641 c 0,0 2.878093,-0.549042 3.802334,-0.868102 1.072703,-0.370312 1.962467,-1.006997 2.645541,-1.913216 0.697956,-0.925962 1.388552,-3.949732 1.388552,-3.949732 0,0 -2.500211,0.766388 -3.34179,1.183607 -1.072554,0.531725 -2.078069,1.404728 -2.750183,2.309638 -0.561074,0.75541 -1.744454,3.237805 -1.744454,3.237805 z\"\n       id=\"path18\"\n       inkscape:label=\"Eye\"\n       sodipodi:nodetypes=\"csscssc\" />\n    <rect\n       style=\"display:inline;fill:url(#radialGradient41);stroke:url(#linearGradient42);stroke-width:0.264999;stroke-dasharray:none;stroke-opacity:0\"\n       id=\"rect78\"\n       width=\"20.58552\"\n       height=\"25.862976\"\n       x=\"47.129463\"\n       y=\"33.312397\"\n       inkscape:label=\"eyeGlare\"\n       ry=\"0.18927498\"\n       sodipodi:insensitive=\"true\" />\n    <path\n       style=\"display:inline;fill:url(#linearGradient43);stroke:none;stroke-width:0.264999\"\n       d=\"m 74.056145,71.830116 -6.377758,-9.174649 c 0,0 1.834834,0.527506 4.694982,-0.105829 2.754802,-0.610008 4.14048,-9.465555 4.14048,-9.465555 z\"\n       id=\"path25\"\n       inkscape:label=\"NeckShadow\"\n       sodipodi:nodetypes=\"ccscc\" />\n  </g>\n</svg>\n"},

    };
  }
}
